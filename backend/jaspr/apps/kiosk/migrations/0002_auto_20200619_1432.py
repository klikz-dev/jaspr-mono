# Generated by Django 2.2.13 on 2020-06-19 21:32

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ("knox", "0007_auto_20190111_0542"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ("clinics", "0002_auto_20200619_1432"),
        ("awsmedia", "0001_initial"),
        ("stability_plan", "0001_initial"),
        ("kiosk", "0001_initial"),
    ]

    operations = [
        migrations.AddField(
            model_name="patient",
            name="current_walkthrough_step",
            field=models.ForeignKey(
                blank=True,
                help_text="Most recent stored Walkthrough Step. Can be overridden when field is old.",
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                to="stability_plan.WalkthroughStep",
                verbose_name="Current Walkthrough Step",
            ),
        ),
        migrations.AddField(
            model_name="patient",
            name="privacy_screen_image",
            field=models.ForeignKey(
                blank=True,
                help_text="This image has been chosen by this patient to be the image they use in their privacy screen.",
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                to="awsmedia.PrivacyScreenImage",
                verbose_name="Chosen Privacy Screen Image",
            ),
        ),
        migrations.AddField(
            model_name="patient",
            name="user",
            field=models.OneToOneField(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="patient",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="jasprsession",
            name="auth_token",
            field=models.OneToOneField(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="jaspr_session",
                related_query_name="jaspr_session",
                to="knox.AuthToken",
                verbose_name="Auth Token",
            ),
        ),
        migrations.AddField(
            model_name="historicaltopic",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicaltechnician",
            name="clinic",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="clinics.Clinic",
            ),
        ),
        migrations.AddField(
            model_name="historicaltechnician",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicaltechnician",
            name="user",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalsharedstory",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalsharedstory",
            name="person",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Person",
                verbose_name="Person",
            ),
        ),
        migrations.AddField(
            model_name="historicalsharedstory",
            name="topic",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Topic",
                verbose_name="Topic",
            ),
        ),
        migrations.AddField(
            model_name="historicalsharedstory",
            name="video",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                limit_choices_to=models.Q(file_type="video"),
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="awsmedia.Media",
                verbose_name="Video",
            ),
        ),
        migrations.AddField(
            model_name="historicalperson",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientvideo",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientvideo",
            name="patient",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Patient",
                verbose_name="Patient",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientvideo",
            name="video",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="awsmedia.Media",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientcopingstrategy",
            name="category",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.CopingStrategyCategory",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientcopingstrategy",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientcopingstrategy",
            name="patient",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Patient",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientactivity",
            name="activity",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Activity",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientactivity",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalpatientactivity",
            name="patient",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Patient",
                verbose_name="Patient",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatient",
            name="clinic_location",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="clinics.ClinicLocation",
                verbose_name="Clinic Location",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatient",
            name="current_walkthrough_step",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                help_text="Most recent stored Walkthrough Step. Can be overridden when field is old.",
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="stability_plan.WalkthroughStep",
                verbose_name="Current Walkthrough Step",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatient",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalpatient",
            name="privacy_screen_image",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                help_text="This image has been chosen by this patient to be the image they use in their privacy screen.",
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="awsmedia.PrivacyScreenImage",
                verbose_name="Chosen Privacy Screen Image",
            ),
        ),
        migrations.AddField(
            model_name="historicalpatient",
            name="user",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalguidemessage",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalcopingstrategycategory",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalcopingstrategy",
            name="category",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.CopingStrategyCategory",
            ),
        ),
        migrations.AddField(
            model_name="historicalcopingstrategy",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalassessment",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalassessment",
            name="patient",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="kiosk.Patient",
            ),
        ),
        migrations.AddField(
            model_name="historicalactivity",
            name="history_user",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="historicalactivity",
            name="video",
            field=models.ForeignKey(
                blank=True,
                db_constraint=False,
                default=None,
                null=True,
                on_delete=django.db.models.deletion.DO_NOTHING,
                related_name="+",
                to="awsmedia.Media",
            ),
        ),
        migrations.AddField(
            model_name="copingstrategy",
            name="category",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                to="kiosk.CopingStrategyCategory",
            ),
        ),
        migrations.AddField(
            model_name="assessment",
            name="patient",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE, to="kiosk.Patient"
            ),
        ),
        migrations.AddField(
            model_name="activity",
            name="video",
            field=models.ForeignKey(
                blank=True,
                default=None,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                to="awsmedia.Media",
            ),
        ),
        migrations.AddField(
            model_name="activaterecord",
            name="patient",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                to="kiosk.Patient",
                verbose_name="Patient",
            ),
        ),
        migrations.AddField(
            model_name="activaterecord",
            name="technician",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                to="kiosk.Technician",
                verbose_name="Technician",
            ),
        ),
        migrations.AddField(
            model_name="action",
            name="patient",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                to="kiosk.Patient",
                verbose_name="Patient",
            ),
        ),
        migrations.AddConstraint(
            model_name="sharedstory",
            constraint=models.UniqueConstraint(
                condition=models.Q(status="Active"),
                fields=("person", "topic"),
                name="shared_story_active_unique_together_person_topic",
            ),
        ),
        migrations.AddConstraint(
            model_name="sharedstory",
            constraint=models.UniqueConstraint(
                condition=models.Q(status="Active"),
                fields=("person", "video"),
                name="shared_story_active_unique_together_person_video",
            ),
        ),
        migrations.AddConstraint(
            model_name="patientvideo",
            constraint=models.UniqueConstraint(
                condition=models.Q(status="active"),
                fields=("patient", "video"),
                name="unique_active_patient_video",
            ),
        ),
        migrations.AddConstraint(
            model_name="patientcopingstrategy",
            constraint=models.UniqueConstraint(
                fields=("title", "patient"),
                name="patientcopingstrategy_title_and_patient_unique_together",
            ),
        ),
        migrations.AddConstraint(
            model_name="patientactivity",
            constraint=models.UniqueConstraint(
                condition=models.Q(status="active"),
                fields=("patient", "activity"),
                name="unique_active_patient_activity",
            ),
        ),
        migrations.AddConstraint(
            model_name="activity",
            constraint=models.UniqueConstraint(
                condition=models.Q(
                    ("status", "active"), models.Q(_negated=True, target_url="")
                ),
                fields=("target_url",),
                name="activity_unique_target_url_ignoring_blank",
            ),
        ),
    ]
